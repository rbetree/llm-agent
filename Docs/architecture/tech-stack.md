# 技术栈

LLM Agent项目采用了一系列现代技术和框架，以下是项目的核心技术栈说明。

## 开发平台

- **.NET 8.0**: 最新的.NET平台，提供高性能、跨平台的开发环境
- **Windows Forms**: 用于构建Windows桌面应用程序的UI框架
- **Visual Studio 2022**: 主要开发工具，提供强大的设计器和调试功能

## 数据存储

- **SQLite**: 轻量级嵌入式数据库，用于存储聊天历史和模型信息
- **JSON**: 用于配置文件和渠道信息的序列化和持久化
- **Settings API**: .NET内置的应用程序设置管理机制

## 第三方API集成

- **REST API客户端**: 用于与各LLM服务提供商通信
- **HTTP客户端工厂**: 实现高效的HTTP连接复用
- **异步API调用**: 确保UI响应性和高效的网络通信

## 核心库和框架

- **System.Text.Json**: 用于JSON序列化和反序列化
- **System.Data.SQLite**: SQLite数据库访问
- **System.Net.Http**: HTTP客户端实现
- **System.ComponentModel**: 用于实现属性通知和数据绑定

## UI组件和控件

- **自定义控件**: 扩展标准Windows Forms控件，实现特定功能
- **SplitContainer**: 实现可调整大小的多面板布局
- **RichTextBox**: 支持富文本显示，用于渲染Markdown格式消息
- **ContextMenuStrip**: 提供上下文菜单功能

## 设计模式应用

项目中应用了多种设计模式，确保代码的可维护性和可扩展性：

1. **工厂模式**: 
   - `ProviderFactory` 用于创建不同的LLM提供商实例
   - 根据配置动态选择合适的提供商实现

2. **仓储模式**:
   - `ChatRepository` 封装数据访问逻辑
   - 提供统一的数据操作接口

3. **单例模式**:
   - `DatabaseManager` 确保数据库连接的唯一性
   - `ChannelManager` 管理渠道配置的全局访问

4. **策略模式**:
   - 不同的LLM提供商实现相同的接口
   - 运行时可以无缝切换不同的提供商

5. **观察者模式**:
   - 使用事件机制实现UI和业务逻辑层的松耦合通信
   - 聊天消息更新通知机制

## 多线程和异步处理

- **Task-based Asynchronous Pattern (TAP)**: 使用async/await实现异步操作
- **UI线程同步**: 确保从工作线程安全更新UI
- **取消令牌支持**: 允许用户取消长时间运行的操作
- **进度报告**: 实现IProgress&lt;T&gt;接口提供操作进度反馈

## 安全性考虑

- **敏感数据保护**: API密钥等敏感信息的安全存储
- **输入验证**: 防止恶意输入和注入攻击
- **错误处理**: 避免暴露敏感的错误信息
- **最小权限原则**: 应用程序只请求必要的系统权限

## 测试框架

- **MSTest**: 单元测试框架
- **Moq**: 模拟框架，用于隔离测试依赖
- **测试覆盖率分析**: 确保关键代码路径的测试覆盖

## 部署和分发

- **ClickOnce**: 简化应用程序的部署和更新
- **自包含部署**: 包含所有依赖项的单一可执行文件
- **安装程序**: 提供用户友好的安装体验

## 开发工具链

- **Git**: 版本控制系统
- **GitHub Actions**: CI/CD自动化
- **NuGet**: 包管理器，管理第三方依赖
- **Visual Studio Code**: 轻量级编辑器，用于快速编辑和查看 